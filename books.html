<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Our Books – Live by Quran</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap" rel="stylesheet">
  <style>
    /*──────────────── Reset & Background ────────────────*/
    * { margin:0; padding:0; box-sizing:border-box }
    html, body { height:100%; overflow-x:hidden; font-family:Calibri, sans-serif }
    body {
      background: url('booksbg.png') center top / cover fixed no-repeat;
      color: #222;
    }

    /*──────────────── Header ────────────────*/
    header {
      position:sticky; top:0; z-index:10;
      background:rgba(255,255,255,0.95);
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
      display:flex; align-items:center; justify-content:space-between;
      padding:1rem 2rem;
    }
    header .logo img { height:40px }
    nav a {
      margin-left:1.5rem; color:#333;
      text-decoration:none; font-weight:500;
    }
    nav a:hover { color:#000 }

    /*──────────────── Main ────────────────*/
    main {
      max-width:1200px; margin:2rem auto;
      padding:0 1rem;
    }
    main h1 {
      font-family:'Playfair Display',serif;
      font-size:2.5rem; text-align:center;
      margin-bottom:2rem;
    }

    /*──────────────── Featured ────────────────*/
    .featured {
      margin-bottom:3rem;
      display:flex; justify-content:center;
    }
    .card {
      background:rgba(255,255,255,0.9);
      border-radius:8px; overflow:hidden;
      box-shadow:0 4px 12px rgba(0,0,0,0.1);
      max-width:360px; display:flex; flex-direction:column;
      transition:transform .2s;
    }
    .card:hover { transform:translateY(-4px) }
    .card img {
      width:100%; height:auto; object-fit:cover;
    }
    .card-content {
      padding:1rem; flex:1; display:flex; flex-direction:column;
    }
    .card-content h3 {
      margin-bottom:.5rem; font-size:1.4rem;
    }
    .card-content p {
      flex:1; font-size:.95rem; color:#555;
      margin-bottom:1rem; line-height:1.4;
    }
    .actions {
      display:flex; gap:.5rem;
      padding:0 1rem 1rem;
    }
    .actions a {
      flex:1; padding:.5em 0;
      text-align:center; border:1px solid #333;
      border-radius:4px; font-size:.9rem;
      color:#333; transition:background .2s,color .2s;
    }
    .actions a:hover {
      background:#333; color:#fff;
    }

    /*──────────────── Grid ────────────────*/
    .grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
      gap:2rem;
    }
  </style>
</head>
<body>

  <header>
    <div class="logo">
      <a href="index.html">
        <img src="Livebyquran Logo.PNG" alt="Live by Quran">
      </a>
    </div>
    <nav>
      <a href="index.html">Home</a>
      <a href="books.html">Books</a>
      <a href="lectures.html">Lectures</a>
      <a href="articles.html">Articles</a>
      <a href="qa.html">Q&A</a>
    </nav>
  </header>

  <main>
    <h1>Our Books</h1>

    <div class="featured" id="featured-container"></div>

    <div class="grid" id="books-grid"></div>
  </main>

  <!-- PapaParse for CSV -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <script>
    Papa.parse('assets/books/books.csv', {
      download: true,
      header: true,
      skipEmptyLines: true,
      complete: ({ data }) => {
        // filter out any empty rows
        const books = data.filter(b => b.slug && b.cover && b.pdf);
        if (!books.length) {
          document.getElementById('books-grid')
            .innerHTML = '<p style="color:red;">No books found in CSV.</p>';
          return;
        }

        // build a card
        function makeCard(b) {
          // path to cover + pdf
          const coverPath = `assets/books/${b.slug}/${b.cover}`;
          const pdfPath   = `assets/books/${b.slug}/${b.pdf}`;
          const readerUrl = `reader.html?book=${encodeURIComponent(b.slug)}`;

          const div = document.createElement('div');
          div.className = 'card';
          div.innerHTML = `
            <img src="${coverPath}" alt="${b.title}">
            <div class="card-content">
              <h3>${b.title}</h3>
              <p>${b.description || ''}</p>
            </div>
            <div class="actions">
              <a href="${readerUrl}"   target="_blank">Read Preview</a>
              <a href="${pdfPath}"      download>Download PDF</a>
              <a href="order.html?book=${encodeURIComponent(b.slug)}">
                Order Print
              </a>
            </div>`;
          return div;
        }

        // Featured = first row
        const featured = makeCard(books[0]);
        document.getElementById('featured-container')
                .appendChild(featured);

        // The rest
        const grid = document.getElementById('books-grid');
        books.slice(1).forEach(b => grid.appendChild(makeCard(b)));
      },
      error: (err) => {
        console.error('CSV load error:', err);
        document.getElementById('books-grid')
          .innerHTML = '<p style="color:red;">Failed to load books CSV.</p>';
      }
    });
  </script>
</body>
</html>
